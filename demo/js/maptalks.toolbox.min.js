/*!
 * maptalks.toolbox v0.1.0
 * LICENSE : MIT
 * (c) 2016-2017 maptalks.org
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("maptalks")):"function"==typeof define&&define.amd?define(["exports","maptalks"],e):e(t.maptalks=t.maptalks||{},t.maptalks)}(this,function(t,e){"use strict";function o(t,e){for(var o=Object.getOwnPropertyNames(e),i=0;i<o.length;i++){var n=o[i],r=Object.getOwnPropertyDescriptor(e,n);r&&r.configurable&&void 0===t[n]&&Object.defineProperty(t,n,r)}return t}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):o(t,e))}var l={eventsToStop:"mousedown dblclick click",autoPan:!1,style:"maptalks-toolbox",vertical:!1,items:[]},s=function(t){function o(e){return i(this,o),n(this,t.call(this,e))}return r(o,t),o.prototype._getClassName=function(){return"Toolbox"},o.prototype.addTo=function(t){return e.ui.UIComponent.prototype.addTo.apply(this,arguments)},o.prototype.setItems=function(t){return this.options.items=t,this},o.prototype.getItems=function(){return this.options.items||[]},o.prototype.getSize=function(){return this._size?this._size.copy():null},o.prototype.buildOn=function(){var t=e.DomUtil.createEl("div");this.options.style&&e.DomUtil.addClass(t,this.options.style);var o=this.options.items;if(o&&o.length>0){for(var i=0,n=0,r=0,l=o.length;r<l;r++){var s=o[r];if(!s.hidden){s.vertical=s.vertical||this.options.vertical;var p=this._createMenuDom(s);t.appendChild(p),i+=(s.width||0)+4,n+=(s.height||0)+2}}this.options.vertical?t.style.height=n+"px":t.style.width=i+"px"}return this._toolboxDom=t,t},o.prototype._getWidth=function(){var t=this.options.width;return t||(t=160),t},o.prototype.getEvents=function(){return{"_zoomstart _zoomend _movestart":this.hide}},o.prototype.onDomRemove=function(){this._removeDomEvents(this._toolboxDom)},o.prototype._removeDomEvents=function(t){if(t)for(var e=t.childNodes,o=0,i=e.length;o<i;o++){var n=e[o];n&&n.childNodes.length>0?this._removeDomEvents(n):this._removeEventsFromDom(n)}},o.prototype._removeEventsFromDom=function(t){e.DomUtil.off(t,"click").off(t,"mouseover").off(t,"mouseout").off(t,"mousedown").off(t,"dblclick").off(t,"contextmenu"),e.DomUtil.removeDomNode(t),t=null},o.prototype._createMenuDom=function(t,o){var i=e.DomUtil.createEl("span");o&&(i=e.DomUtil.createEl(o));var n=t.width||16,r=t.height||16,l=t.vertical;void 0!==l&&null!=l||(l=!1);var s="inline-block";l&&(s="block"),i.style.cssText="text-align:center;display:-moz-inline-box;display:"+s+";width:"+n+"px;height:"+r+"px;",e.DomUtil.addClass(i,"maptalks-toolbox-button"),i.appendChild(this._createIconDom(t)),t.click&&e.DomUtil.on(i,"click",t.click,this),t.mouseover&&e.DomUtil.on(i,"mouseover",t.mouseover,this),t.mouseout&&e.DomUtil.on(i,"mouseout",t.mouseout,this),t.mousedown&&e.DomUtil.on(i,"mousedown",t.mousedown,this),t.mouseup&&e.DomUtil.on(i,"mouseup",t.mouseup,this),this._addEventToMenuItem(i,t);var p=this,c=t.trigger||"click";return"click"===c?e.DomUtil.on(i,"click",function(){p._showDropMenu(i,t)},this):"mouseover"===c&&e.DomUtil.on(i,"mouseover",function(){p._showDropMenu(i,t)},this),i},o.prototype._addEventToMenuItem=function(t,o){if(o.children&&o.children.length>0){var i=this,n=i._createDropMenu(t,o),r=o.trigger;"click"===r?(e.DomUtil.on(t,"click",function(){e.DomUtil.setStyle(n,"display : block")},this),e.DomUtil.on(n,"mouseover",function(){e.DomUtil.setStyle(n,"display : block")},this)):"mouseover"===r&&e.DomUtil.on(t,"mouseover",function(){e.DomUtil.setStyle(n,"display : block")},this),e.DomUtil.on(t,"mouseout",function(){e.DomUtil.setStyle(n,"display : none"),n.style.cssText="position: absolute; top: -10000px; left: -10000px;"},this),e.DomUtil.on(n,"mouseout mouseup",function(){e.DomUtil.setStyle(n,"display : none"),n.style.cssText="position: absolute; top: -10000px; left: -10000px;"},this)}},o.prototype._showDropMenu=function(t,e){if(e.children&&e.children.length>0){var o=this._getDropdownMenuOffset(t,e);t.lastChild.style.cssText="position: absolute; top:"+o.top+"px; left:"+o.left+"px;",this.fire("showmenuend")}},o.prototype._getDropdownMenuOffset=function(t,o){var i=o.children,n=16,r=16;if(i&&i.length>0)for(var l=0;l<i.length;l++){var s=i[l];n+=s.height||0,r+=s.width||0}var p=document.body.clientHeight,c=document.body.clientWidth,u=t.clientHeight,a=t.clientWidth,h=e.DomUtil.getPagePosition(t),m=h.y,f=h.x,d=o.vertical;void 0!==d&&null!=d||(d=!1);var v=u,y=a;return d?(y=f+a+r>c?-(3*a/2+r):a,v=t.offsetTop):(v=m+u+n>p?u/2-n:u,y=t.offsetLeft),{top:v,left:y}},o.prototype._createDropMenu=function(t,e){var o=e.vertical;void 0!==o&&null!=o||(o=!1);var i="position: absolute;";return i+=o?"left: -10000px;":"top: -10000px;",this._createDropMenuDom(t,e,i)},o.prototype._createDropMenuDom=function(t,o,i){var n=t.children[1];n&&e.DomUtil.removeDomNode(n);var r=e.DomUtil.createElOn("ul",i),l=o.children;if(l&&l.length>0)for(var s=0,p=l.length;s<p;s++){var c=l[s];void 0===c.vertical&&(c.vertical=!(c.vertical||o.vertical)),r.appendChild(this._createMenuDom(c,"li"))}return t.appendChild(r),r},o.prototype._createIconDom=function(t){var o=e.DomUtil.createEl("span"),i=t.icon,n=t.item,r=t.title,l=t.html;if(i){var s=t.iconWidth||t.width,p=t.iconHeight||t.height,c=e.DomUtil.createEl("img");return c.src=i,c.border=0,c.width=s,c.height=p,r&&(c.title=r),o.appendChild(c),n&&(l?"string"==typeof n?o.innerText=n:o.appendChild(n):o.innerText=n),o}return n&&("string"==typeof n?o.innerText=n:o.appendChild(n)),l&&o.appendChild(n),o},o}(e.ui.UIComponent);s.mergeOptions(l),t.Toolbox=s,Object.defineProperty(t,"__esModule",{value:!0})});